<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Paniya Digital Success ID Generator</title>
<style>
  body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; margin-top: 30px; }
  input, button { margin: 5px; padding: 8px; font-size: 16px; }
  canvas { border: 1px solid #ccc; margin-top: 20px; }
</style>
</head>
<body>
<h2>Paniya Digital Success - ID Generator</h2>
<label>Choose Background Image: <input type="file" id="bgInput" accept="image/*"></label><br>
<label>Name: <input type="text" id="nameInput"></label><br>
<label>Mobile: <input type="text" id="mobileInput"></label><br>
<label>Gender: <input type="text" id="genderInput"></label><br>
<label>Country: <input type="text" id="countryInput"></label><br>
<button id="generateBtn" disabled onclick="generateID()">Generate ID</button>
<br>
<canvas id="idCanvas"></canvas>
<script>
const canvas = document.getElementById('idCanvas');
const ctx = canvas.getContext('2d');
let bgImage = new Image();
let idCounter = 1;
const generateBtn = document.getElementById('generateBtn');

document.getElementById('bgInput').addEventListener('change', function(e){
  const file = e.target.files[0];
  if(file){
    const reader = new FileReader();
    reader.onload = function(evt){
      bgImage.src = evt.target.result;
      bgImage.onload = () => {
        // Resize canvas to image size
        canvas.width = bgImage.width;
        canvas.height = bgImage.height;
        ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);
        generateBtn.disabled = false; // enable button after image load
      };
    };
    reader.readAsDataURL(file);
  }
});

function generateID(){
  if(!bgImage.src) return;
  // Clear canvas
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);

  // Auto-generate ID
  const dateStr = new Date().toISOString().slice(0,10).replace(/-/g,'');
  const autoID = 'PDS-' + dateStr + '-' + String(idCounter).padStart(3,'0');
  idCounter++;

  // Text style
  ctx.fillStyle = '#000';
  ctx.textAlign = 'left';
  let fontSize = Math.floor(canvas.height * 0.03); // 3% of height
  ctx.font = fontSize + 'px Arial';

  // Draw user details (relative positions)
  ctx.fillText('Name: ' + document.getElementById('nameInput').value, canvas.width*0.08, canvas.height*0.72);
  ctx.fillText('Mobile: ' + document.getElementById('mobileInput').value, canvas.width*0.08, canvas.height*0.77);
  ctx.fillText('Gender: ' + document.getElementById('genderInput').value, canvas.width*0.08, canvas.height*0.82);
  ctx.fillText('Country: ' + document.getElementById('countryInput').value, canvas.width*0.08, canvas.height*0.87);
  ctx.fillText('ID: ' + autoID, canvas.width*0.08, canvas.height*0.92);

  // Auto download
  const link = document.createElement('a');
  link.download = autoID + '_' + document.getElementById('nameInput').value + '.png';
  link.href = canvas.toDataURL();
  link.click();
}
</script>
</body>
</html>
